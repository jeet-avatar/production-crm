# Trivy Configuration File
# Documentation: https://trivy.dev/latest/docs/references/configuration/config-file/

# Scan settings
scan:
  scanners:
    - vuln        # Vulnerability scanning
    - secret      # Secret detection
    - config      # Misconfiguration detection

  # Skip specific directories
  skip-dirs:
    - node_modules
    - dist
    - build
    - coverage
    - .git

  # Skip specific files
  skip-files:
    - "**/*.test.ts"
    - "**/*.spec.ts"
    - "**/*.md"

# Vulnerability settings
vulnerability:
  type:
    - os          # OS packages
    - library     # Application dependencies

  # Severity levels to report
  severity:
    - CRITICAL
    - HIGH
    - MEDIUM

  # Ignore unfixed vulnerabilities (no patch available)
  ignore-unfixed: false

# Secret detection settings
secret:
  config: .trivysecret.yaml  # Custom secret scanning rules (optional)

# Misconfiguration settings
misconfiguration:
  # Include all checks
  include-deprecated-checks: false

  # Severity levels for misconfigurations
  severity:
    - CRITICAL
    - HIGH
    - MEDIUM

# Output settings
format: table  # Options: table, json, sarif, cyclonedx, spdx
output: ""     # Leave empty for stdout, or specify file path

# Cache settings
cache:
  backend: fs  # Filesystem cache

# Timeout settings
timeout: 5m

# Ignore file
ignorefile: .trivyignore

# Exit code (fail CI/CD on findings)
exit-code: 1  # Exit with code 1 if vulnerabilities found
exit-on-eol: 0  # Don't fail on end-of-life OS
